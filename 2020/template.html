<!DOCTYPE html>
<html lang="en">
<head>
    <title>AOC 2020</title>
    <style>
        #gauge{
            min-height:1em; 
            min-width:1em;
            background-color:lightblue;
        }
        #log{
            margin:1em;
            font-family:"Courier New", Courier, monospace
        }
        @keyframes redFade {
            0% {color:red}
            100% {color:black}
        }
        #log div{
            animation-name: redFade;
            animation-duration: 0.5s
        }

    </style>
    <script>
        let stopNow = false;
        let stepDelay = 5;
        function showAnswer(answer){
            gauge('');
            document.getElementById('userStop').disabled = true;
            document.getElementById('answer').value = answer;
        }
        function getInput(){
            return document.getElementById("input").innerText;
        }
        function gauge(g){
            document.getElementById("gauge").innerHTML = g;
        }
        function log(msg){
            let n = document.createElement("div");
            n.innerHTML = msg;
            document.getElementById("log").prepend(n);
        }
        function step(){
            if (!stopNow)
                return new Promise(resolve => {
                    setTimeout(resolve, stepDelay);
                });
            stopNow = false;
            return Promise.reject("User cancelled");
        }
        function changeDelay(t){
            stepDelay = parseInt(t.value);
        }
        function userStop(){
            stopNow = true;
        }
        function doSolve(n){
            document.getElementById('userStop').disabled = false;
            document.getElementById('answer').value = '';
            switch (n) { 
                case 1: solve1(getInput(), step); break;
                case 2: solve2(getInput(), step); break;
            }
        }
        function clearLog(){
            document.getElementById('log').innerHTML = '';
        }
    </script>
    <script src="/script/utils.js"></script>
    <script src="/script/{{ day }}/solve1.js"></script>
    <script src="/script/{{ day }}/solve2.js"></script>
</head>
<body>
    <div id='buttons'>
        <button onclick='doSolve(1)'>Solve part 1</button>
        <button onclick='doSolve(2)'>Solve part 2</button>
        <br />
        Step Delay<input id='stepDelay' value='5' onchange='changeDelay(this)' />
        <button id='userStop' onclick='userStop()' disabled>Stop Processing</button>
        <button onclick='clearLog()'>Clear Log</button>
    </div>
    <div>Answer:<input id='answer' readonly></input></div>
    <div id='gauge'></div>
    <canvas id='canvas' style='display:none' height=800 width=600></canvas>
    <div id='log'></div>
    <xmp id='input' style='display:none'>{{ input }}</xmp>
</body>
</html>